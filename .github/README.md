# GitHub Actions 工作流

这个目录包含了项目使用的GitHub Actions工作流配置。

## 自动同步上游仓库的Main分支

文件: `workflows/sync-from-upstream.yml`

### 功能

该工作流会定期检查上游仓库 (https://github.com/noro6/kc-web) 的main分支是否有新的提交，如果有新的提交，将尝试将这些更改合并到当前仓库的main分支。工作流会根据仓库状态智能选择合适的同步策略。

这个功能可以帮助确保你的仓库与上游仓库保持同步，获取最新的功能和修复。

### 智能同步策略

工作流遵循以下策略进行同步：

- 只有在上游仓库有新提交时才会尝试同步
- 会先在临时分支上尝试合并，确保可以无冲突合并
- 如果本地仓库有自己的提交，会使用常规合并保留提交历史
- 如果本地仓库没有自己的提交，会使用快进合并
- 如果合并会导致冲突，会创建一个Issue通知开发者手动处理

### 触发条件

- **定时触发**: 每天凌晨2点自动运行
- **手动触发**: 可以通过GitHub界面手动触发工作流

### 手动触发方式

1. 在GitHub仓库页面，点击顶部的"Actions"标签
2. 在左侧找到"Sync from Upstream Main Branch"工作流
3. 点击"Run workflow"按钮
4. 点击绿色的"Run workflow"按钮开始同步检查

### 工作流程

1. 检出当前仓库的main分支
2. 添加上游仓库作为远程引用
3. 检查本地与上游仓库的提交关系
4. 在临时分支上尝试合并，检查是否会有冲突
5. 如果可以无冲突合并，根据是否有本地提交选择合适的合并策略
6. 将合并结果推送到当前仓库
7. 如果不能自动合并，创建一个Issue通知开发者手动处理

### 注意事项

- 工作流会检测上游仓库的新提交，即使本地有自己的提交也会尝试同步
- 同步过程保留本地的所有提交历史
- 如果合并会导致冲突，工作流不会自动合并，而是创建一个Issue
- 工作流会将更改推送到main分支，所以请确保你有相应的权限 